
BEGIN:VCALENDAR
VERSION:2.0
PRODID:{{.Title}}
NAME:{{.Title}}
UID:{{.Permalink}}
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VTIMEZONE
TZID:Europe/Warsaw
X-LIC-LOCATION:Europe/Warsaw
BEGIN:DAYLIGHT
TZOFFSETFROM:+0100
TZOFFSETTO:+0200
TZNAME:CEST
DTSTART:19700329T020000
RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=-1SU
END:DAYLIGHT
BEGIN:STANDARD
TZOFFSETFROM:+0200
TZOFFSETTO:+0100
TZNAME:CET
DTSTART:19701025T030000
RRULE:FREQ=YEARLY;BYMONTH=10;BYDAY=-1SU
END:STANDARD
END:VTIMEZONE
{{ $allPages := where (where .Site.AllPages "Type" "==" $.Page.Type) "Kind" "page" }}
{{$events := partial "getEventsForPages.html" (dict
  "pages" $allPages
  "default_timezone" "Europe/Warsaw"
)
}}
{{ range $event := $events }}
BEGIN:VEVENT
{{ with $event.page.Params.organizer}}ORGANIZER;CN="{{ .name }}":mailto:{{ .email }}{{ end }}
SUMMARY:{{if $event.cancelled}}CANCELLED: {{end}}{{$event.page.Title}}{{with $event.comment}} -- {{.}}{{end}}
UID:{{$event.page.Title | urlize}}-{{dateFormat "20060102T150405" $event.startDateTime}}@hs3.pl
SEQUENCE:0
STATUS:{{if .cancelled}}CANCELLED{{else}}CONFIRMED{{end}}
DTSTAMP:{{dateFormat "20060102T150405" $event.startDateTime}}
DTSTART:{{dateFormat "20060102T150405" $event.startDateTime}}
DTEND:{{dateFormat "20060102T150405" $event.endDateTime}}
LOCATION:TBD
URL:{{$event.page.Permalink}}
END:VEVENT
{{end}}
END:VCALENDAR
